@model Promos.Web.Models.Step3Vm
<h2>Ingresá tus datos</h2>
<form asp-action="Registrar" method="post">
    <input type="hidden" asp-for="Codigo" />
    <input type="hidden" asp-for="SelectedArticuloId" />

    <div class="row g-3">
        <div class="col-md-4">
            <label class="form-label">DNI</label>
            <input asp-for="Documento" class="form-control" id="dni" />
            <span asp-validation-for="Documento" class="text-danger"></span>
        </div>
        <div class="col-md-4">
            <label class="form-label">Nombre</label>
            <input asp-for="Nombre" class="form-control" />
            <span asp-validation-for="Nombre" class="text-danger"></span>
        </div>
        <div class="col-md-4">
            <label class="form-label">Apellido</label>
            <input asp-for="Apellido" class="form-control" />
            <span asp-validation-for="Apellido" class="text-danger"></span>
        </div>
        <div class="col-md-6">
            <label class="form-label">Email</label>
            <input asp-for="Email" class="form-control" />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>
        <div class="col-md-6">
            <label class="form-label">Dirección</label>
            <input asp-for="Direccion" class="form-control" />
            <span asp-validation-for="Direccion" class="text-danger"></span>
        </div>
        <div class="col-md-6">
            <label class="form-label">Ciudad</label>
            <input asp-for="Ciudad" class="form-control" />
            <span asp-validation-for="Ciudad" class="text-danger"></span>
        </div>
        <div class="col-md-2">
            <label class="form-label">CP</label>
            <input asp-for="CP" class="form-control" />
            <span asp-validation-for="CP" class="text-danger"></span>
        </div>
    </div>

    <div class="form-check mt-3">
        <input class="form-check-input" type="checkbox" required id="tyc">
        <label class="form-check-label" for="tyc">Acepto los términos y condiciones.</label>
    </div>

    <button class="btn btn-success mt-3">Participar!</button>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Prefill simple por DNI (fetch a una mini acción opcional)
        document.getElementById('dni').addEventListener('change', async (e) => {
          const dni = e.target.value;
          if (!dni) return;
          const r = await fetch(`/api/clientes/by-dni/${dni}`);
          if (r.ok) {
            const c = await r.json();
            if (c) {
              document.querySelector('[name="Nombre"]').value = c.nombre;
              document.querySelector('[name="Apellido"]').value = c.apellido;
              document.querySelector('[name="Email"]').value = c.email;
              document.querySelector('[name="Direccion"]').value = c.direccion;
              document.querySelector('[name="Ciudad"]').value = c.ciudad;
              document.querySelector('[name="CP"]').value = c.cp;
            }
          }
        });
    </script>
}
